{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\sites\\\\github\\\\courses\\\\sermon-outlines\\\\stephen-reynolds-jr\\\\Youth Revelation Study\\\\youth-bible-study\\\\pages\\\\editor\\\\[course].js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { useState, Component } from 'react';\nimport styles from '../../styles/Revelation.module.css';\nimport Head from 'next/head';\nimport { withRouter } from \"next/router\";\nimport eStyles from './Editor.module.css';\nimport SelectLessonForm from '../Common/SelectLessonForm';\nimport Line, { lineTypes, templates } from '../Blocks/Line';\n\nfunction NewLineForm(_ref) {\n  var index = _ref.index,\n      handleNewLine = _ref.handleNewLine;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: \"25px\",\n      backgroundColor: \"#dcdcdc\",\n      color: \"#dcdcdc\",\n      margin: \"15px\",\n      width: \"100%\",\n      textAlign: \"center\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      style: {\n        background: \"none\"\n      },\n      onSubmit: handleNewLine,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"hidden\",\n        name: \"index\",\n        value: index\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 11,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"raw\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 12,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        style: {\n          background: \"none\"\n        },\n        name: \"lineType\",\n        id: \"lineTypes\" + index,\n        defaultValue: \"md\",\n        children: [lineTypes.map(function (t) {\n          return /*#__PURE__*/_jsxDEV(\"option\", {\n            value: t,\n            children: t\n          }, t, false, {\n            fileName: _jsxFileName,\n            lineNumber: 16,\n            columnNumber: 28\n          }, this);\n        }), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"raw\",\n          children: \"raw\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 19,\n          columnNumber: 19\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 14,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        style: {\n          background: \"none\"\n        },\n        type: \"submit\",\n        value: \"+\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 23,\n        columnNumber: 15\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 10,\n      columnNumber: 133\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 10,\n    columnNumber: 11\n  }, this);\n}\n\n_c = NewLineForm;\n\nfunction MoveToLessonForm(_ref2) {\n  var index = _ref2.index,\n      lesson = _ref2.lesson,\n      handleMoveToLesson = _ref2.handleMoveToLesson;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      backgroundColor: \"#dcdcdc\",\n      color: \"#dcdcdc\",\n      margin: \"15px\",\n      width: \"100%\",\n      textAlign: \"center\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      style: {\n        background: \"none\"\n      },\n      onSubmit: handleMoveToLesson,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"hidden\",\n        name: \"index\",\n        value: index\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"lesson\",\n        defaultValue: lesson\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        style: {\n          background: \"none\"\n        },\n        type: \"submit\",\n        value: \"move to lesson\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 15\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 29,\n    columnNumber: 11\n  }, this);\n}\n\n_c2 = MoveToLessonForm;\n\nvar Editor = /*#__PURE__*/function (_Component) {\n  _inherits(Editor, _Component);\n\n  var _super = _createSuper(Editor);\n\n  function Editor(props) {\n    var _this;\n\n    _classCallCheck(this, Editor);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      file: false,\n      lineTypes: lineTypes,\n      lines: [],\n      lesson: 1,\n      lessons: [],\n      showRaw: false\n    };\n    return _this;\n  }\n\n  _createClass(Editor, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      /**/\n    }\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(newProps) {\n      if (newProps.router.query.course !== this.props.router.query.course || this.state.lines === undefined) {\n        var lines = [];\n        var course = newProps.router.query.course;\n\n        if (localStorage.getItem(course) === null) {\n          lines = [];\n          localStorage.setItem(course, JSON.stringify(lines));\n        } else {\n          lines = JSON.parse(localStorage.getItem(course));\n          if (lines === null) lines = [];\n        }\n\n        this.setState({\n          lines: lines,\n          lessons: this.getLessons(lines)\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var handleNewLine = this.handleNewLine.bind(this);\n      var update = this.update.bind(this);\n      var deleteLine = this.deleteLine.bind(this);\n      var moveToLesson = this.handleMoveToLesson.bind(this);\n      var lesson = this.state.lesson;\n      var handleSelectLesson = this.handleSelectLesson.bind(this);\n      var showRaw = this.state.showRaw;\n      var toggleRaw = this.toggleRaw.bind(this);\n      var copyTextToClipboard = this.copyTextToClipboard.bind(this);\n      var rawStyle = {};\n      var columnStyle = {\n        height: \"500px\",\n        overflow: \"scroll\"\n      };\n\n      if (showRaw) {\n        rawStyle = {\n          display: \"block\"\n        };\n      }\n\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Head, {\n          children: [/*#__PURE__*/_jsxDEV(\"title\", {\n            children: \"Block Editor | Youth Revelation Study\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 10\n          }, this), /*#__PURE__*/_jsxDEV(\"link\", {\n            rel: \"icon\",\n            href: \"/favicon.ico\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 10\n          }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n            charset: \"UTF-8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 10\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 8\n        }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            style: {\n              borderBottom: \"solid 2px gray\",\n              position: \"fixed\",\n              top: \"0\",\n              height: \"75px\",\n              backgroundColor: \"white\",\n              width: \"75%\",\n              marginTop: \"0\"\n            },\n            children: [\"Editor | Lesson \", this.state.lesson, \" \", /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: this.save.bind(this),\n              children: \"SAVE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 180\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                \"float\": \"right\",\n                fontSize: \".7rem\"\n              },\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                id: \"input-file\",\n                onChange: this.getFile.bind(this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 104,\n                columnNumber: 280\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 232\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 5\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              height: \"75px\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 5\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: eStyles.row,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: eStyles.column + \" \" + eStyles.smallColumn,\n              children: this.state.lessons.map(function (less, k) {\n                return /*#__PURE__*/_jsxDEV(SelectLessonForm, {\n                  lesson: less,\n                  handleSelectLesson: handleSelectLesson\n                }, k, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 112,\n                  columnNumber: 20\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: eStyles.column,\n              children: [/*#__PURE__*/_jsxDEV(NewLineForm, {\n                index: 0,\n                handleNewLine: handleNewLine\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 17\n              }, this), this.state.lines.map(function (line, i) {\n                if (line.lesson === lesson) {\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: toggleRaw,\n                      children: \"raw\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 126,\n                      columnNumber: 27\n                    }, this), \" >\", /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      readOnly: true,\n                      className: eStyles.raw,\n                      style: rawStyle,\n                      value: JSON.stringify(line),\n                      onClick: copyTextToClipboard\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 127,\n                      columnNumber: 33\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: eStyles.row,\n                      style: {\n                        height: \"400px\",\n                        overflow: \"scroll\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: eStyles.column,\n                        children: [/*#__PURE__*/_jsxDEV(Line, {\n                          index: i,\n                          data: line,\n                          update: update,\n                          style: columnStyle\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 136,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                          style: {\n                            color: \"red\",\n                            marginLeft: \"15px\"\n                          },\n                          onClick: function onClick(e) {\n                            deleteLine(i);\n                          },\n                          children: \"x\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 137,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(MoveToLessonForm, {\n                          index: i,\n                          lesson: line.lesson,\n                          handleMoveToLesson: moveToLesson\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 140,\n                          columnNumber: 33\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 135,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: eStyles.column,\n                        style: {\n                          fontSize: \"60%\",\n                          paddingLeft: \"15px\"\n                        },\n                        children: /*#__PURE__*/_jsxDEV(Line, {\n                          index: i,\n                          data: line,\n                          read: true,\n                          style: columnStyle\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 145,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 144,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(NewLineForm, {\n                        index: i + 1,\n                        handleNewLine: handleNewLine\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 148,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 134,\n                      columnNumber: 29\n                    }, this)]\n                  }, i, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 124,\n                    columnNumber: 26\n                  }, this);\n                }\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 3\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 2\n      }, this);\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      var txt = JSON.stringify(this.state.lines);\n      localStorage.setItem(this.props.router.query.course, txt); // Start file download.\n\n      this.download(this.props.router.query.course + \".json\", txt);\n    }\n  }, {\n    key: \"download\",\n    value: function download(filename, text) {\n      var element = document.createElement('a');\n      element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\n      element.setAttribute('download', filename);\n      element.style.display = 'none';\n      document.body.appendChild(element);\n      element.click();\n      document.body.removeChild(element);\n    }\n  }, {\n    key: \"getFile\",\n    value: function getFile(event) {\n      var _this2 = this;\n\n      var input = event.target;\n\n      if ('files' in input && input.files.length > 0) {\n        var lines = this.placeFileContent(input.files[0]).then(function (lines) {\n          _this2.setState({\n            lines: lines,\n            lessons: _this2.getLessons(lines)\n          });\n        });\n      }\n    }\n  }, {\n    key: \"placeFileContent\",\n    value: function placeFileContent(file) {\n      return this.readFileContent(file).then(function (content) {\n        return JSON.parse(content);\n      })[\"catch\"](function (error) {\n        return console.log(error);\n      });\n    }\n  }, {\n    key: \"readFileContent\",\n    value: function readFileContent(file) {\n      var reader = new FileReader();\n      return new Promise(function (resolve, reject) {\n        reader.onload = function (event) {\n          return resolve(event.target.result);\n        };\n\n        reader.onerror = function (error) {\n          return reject(error);\n        };\n\n        reader.readAsText(file);\n      });\n    }\n  }, {\n    key: \"handleNewLine\",\n    value: function handleNewLine(e) {\n      e.preventDefault();\n      var lineType = e.target.lineType.value;\n      var index = e.target.index.value;\n\n      var newState = _objectSpread({}, this.state);\n\n      if (lineType === \"raw\") {\n        newState.lines.splice(index, 0, _objectSpread(_objectSpread({}, JSON.parse(e.target.raw.value)), {}, {\n          lesson: this.state.lesson\n        }));\n      } else {\n        newState.lines.splice(index, 0, _objectSpread(_objectSpread({}, templates[lineType]), {}, {\n          lesson: this.state.lesson\n        }));\n      }\n\n      newState.lessons = this.getLessons(newState.lines);\n      this.setState(_objectSpread({}, newState));\n    }\n  }, {\n    key: \"handleMoveToLesson\",\n    value: function handleMoveToLesson(e) {\n      e.preventDefault();\n      var lesson = parseInt(e.target.lesson.value);\n      var index = e.target.index.value;\n\n      var newState = _objectSpread({}, this.state);\n\n      newState.lines[index].lesson = lesson;\n      newState.lessons = this.getLessons(newState.lines);\n      this.setState(_objectSpread({}, newState));\n    }\n  }, {\n    key: \"handleSelectLesson\",\n    value: function handleSelectLesson(e) {\n      e.preventDefault();\n      var id = e.target.id.value;\n\n      var newState = _objectSpread({}, this.state);\n\n      newState.lesson = parseInt(id);\n      this.setState(_objectSpread({}, newState));\n    }\n  }, {\n    key: \"update\",\n    value: function update(line, data) {\n      var newState = _objectSpread({}, this.state);\n\n      newState.lines[line] = _objectSpread({}, data);\n      newState.lessons = this.getLessons(newState.lines);\n      this.setState(newState);\n    }\n  }, {\n    key: \"deleteLine\",\n    value: function deleteLine(line) {\n      var newData = _objectSpread({}, this.state);\n\n      newData.lines.splice(line, 1);\n      newData.lessons = this.getLessons(newData.lines);\n      this.setState(newData);\n    }\n  }, {\n    key: \"getLessons\",\n    value: function getLessons(lines) {\n      var lessons = [];\n      var i;\n      var id = 0;\n      var lindex = 0;\n\n      for (i = 0; i < lines.length; i++) {\n        id = parseInt(lines[i].lesson);\n        lindex = id - 1;\n\n        if (lessons[lindex] === undefined) {\n          lessons[lindex] = {\n            id: id,\n            count: 1\n          };\n        } else {\n          lessons[lindex] = {\n            id: id,\n            count: lessons[lindex].count + 1\n          };\n        }\n      }\n\n      return lessons;\n    }\n  }, {\n    key: \"toggleRaw\",\n    value: function toggleRaw(e) {\n      var newState = _objectSpread({}, this.state);\n\n      newState.showRaw = !newState.showRaw;\n      this.setState(newState);\n    }\n  }, {\n    key: \"copyTextToClipboard\",\n    value: function copyTextToClipboard(e) {\n      var context = e.target;\n      context.select();\n      document.execCommand(\"copy\");\n      alert(\"Copied to clipoard!\" + context.value);\n    }\n  }]);\n\n  return Editor;\n}(Component);\n\nexport default _c3 = withRouter(Editor);\n/*\r\n1-4 Ellyanna\r\n5-11 Jeremiah\r\n12-16 Benjamin\r\n17-22 Rosemary\r\n\r\n1. Summaries\r\n2. Conclusing of Book 1 sentence\r\n\r\n\t\t<Quiz line={1} questions={this.state.questions} updateQuestion={updateQuestion}/>\r\n\r\n    */\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"NewLineForm\");\n$RefreshReg$(_c2, \"MoveToLessonForm\");\n$RefreshReg$(_c3, \"%default%\");","map":{"version":3,"sources":["C:/sites/github/courses/sermon-outlines/stephen-reynolds-jr/Youth Revelation Study/youth-bible-study/pages/editor/[course].js"],"names":["useState","Component","styles","Head","withRouter","eStyles","SelectLessonForm","Line","lineTypes","templates","NewLineForm","index","handleNewLine","height","backgroundColor","color","margin","width","textAlign","background","map","t","MoveToLessonForm","lesson","handleMoveToLesson","Editor","props","state","file","lines","lessons","showRaw","newProps","router","query","course","undefined","localStorage","getItem","setItem","JSON","stringify","parse","setState","getLessons","bind","update","deleteLine","moveToLesson","handleSelectLesson","toggleRaw","copyTextToClipboard","rawStyle","columnStyle","overflow","display","borderBottom","position","top","marginTop","save","fontSize","getFile","row","column","smallColumn","less","k","line","i","raw","marginLeft","e","paddingLeft","txt","download","filename","text","element","document","createElement","setAttribute","encodeURIComponent","style","body","appendChild","click","removeChild","event","input","target","files","length","placeFileContent","then","readFileContent","content","error","console","log","reader","FileReader","Promise","resolve","reject","onload","result","onerror","readAsText","preventDefault","lineType","value","newState","splice","parseInt","id","data","newData","lindex","count","context","select","execCommand","alert"],"mappings":"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","sourcesContent":["import { useState, Component } from 'react'\r\nimport styles from '../../styles/Revelation.module.css'\r\nimport Head from 'next/head'\r\nimport { withRouter } from \"next/router\"\r\nimport eStyles from './Editor.module.css'\r\nimport SelectLessonForm from '../Common/SelectLessonForm'\r\nimport Line, {lineTypes, templates} from '../Blocks/Line'\r\n\r\nfunction NewLineForm({index, handleNewLine}){\r\n  return (<div style={{height:\"25px\", backgroundColor:\"#dcdcdc\", color:\"#dcdcdc\", margin:\"15px\", width:\"100%\", textAlign:\"center\"}}><form style={{ background:\"none\"}} onSubmit={handleNewLine}>\r\n              <input type=\"hidden\" name=\"index\" value={index}/>\r\n              <input type=\"text\" name=\"raw\" />\r\n\r\n                <select style={{background:\"none\"}} name=\"lineType\" id={\"lineTypes\" + index} defaultValue=\"md\">\r\n                  {lineTypes.map(function(t){\r\n                    return <option key={t} value={t}>{t}</option>\r\n                  })}\r\n\r\n                  <option value=\"raw\">raw</option>\r\n          </select>\r\n       \r\n\r\n              <input style={{background:\"none\"}} type=\"submit\" value=\"+\" />\r\n            </form></div>)\r\n}\r\n\r\n\r\nfunction MoveToLessonForm({index, lesson, handleMoveToLesson}){\r\n  return (<div style={{backgroundColor:\"#dcdcdc\", color:\"#dcdcdc\", margin:\"15px\", width:\"100%\", textAlign:\"center\"}}>\r\n        <form style={{ background:\"none\"}} onSubmit={handleMoveToLesson}>\r\n              <input type=\"hidden\" name=\"index\" value={index}/>\r\n              <input type=\"text\" name=\"lesson\" defaultValue={lesson}/>\r\n              <input style={{background:\"none\"}} type=\"submit\" value=\"move to lesson\" />\r\n            </form></div>)\r\n}\r\n\r\n\r\n\r\nclass Editor extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n    \tfile:false,\r\n    \tlineTypes: lineTypes,\r\n    \tlines:[],\r\n      lesson: 1,\r\n      lessons:[],\r\n      showRaw: false\r\n    }\r\n  }\r\n\r\n  componentDidMount() { /**/ }\r\n\r\nUNSAFE_componentWillReceiveProps(newProps){\r\n\r\n  if(newProps.router.query.course !== this.props.router.query.course || this.state.lines === undefined){\r\n    \r\n    let lines = []\r\n    const course = newProps.router.query.course\r\n\r\n    if(localStorage.getItem(course) === null){\r\n      lines = [];\r\n      localStorage.setItem(course, JSON.stringify(lines));\r\n    }else{\r\n      lines = JSON.parse(localStorage.getItem(course));\r\n      if(lines === null) lines = []\r\n    }\r\n\r\n    this.setState({\r\n      lines: lines,\r\n      lessons: this.getLessons(lines)\r\n    })\r\n\r\n  }\r\n}\r\n\r\n  render() {\r\n\r\n  \t  const handleNewLine = this.handleNewLine.bind(this)\r\n  \t  const update = this.update.bind(this)\r\n  \t  const deleteLine = this.deleteLine.bind(this)\r\n      const moveToLesson = this.handleMoveToLesson.bind(this)\r\n      const lesson = this.state.lesson\r\n      const handleSelectLesson = this.handleSelectLesson.bind(this)\r\n      const showRaw = this.state.showRaw\r\n      const toggleRaw = this.toggleRaw.bind(this)\r\n      const copyTextToClipboard = this.copyTextToClipboard.bind(this)\r\n      let rawStyle = {}\r\n      const columnStyle = {height:\"500px\", overflow:\"scroll\"}\r\n      if(showRaw){\r\n         rawStyle = {display:\"block\"}        \r\n      }\r\n    return (\r\n\t<div>\r\n\t      <Head>\r\n\t        <title>Block Editor | Youth Revelation Study</title>\r\n\t        <link rel=\"icon\" href=\"/favicon.ico\" />\r\n\t        <meta charset=\"UTF-8\" />\r\n\r\n\t      </Head>\r\n\r\n\t\t<main>\r\n\r\n    <h1 style={{borderBottom:\"solid 2px gray\", position:\"fixed\", top:\"0\", height:\"75px\", backgroundColor:\"white\", width:\"75%\", marginTop:\"0\"}}>Editor | Lesson {this.state.lesson} <button onClick={this.save.bind(this)}>SAVE</button><span style={{float:\"right\", fontSize:\".7rem\"}}><input type=\"file\" id=\"input-file\" onChange={this.getFile.bind(this)} /></span>\r\n    </h1>\r\n\r\n    <div style={{height:\"75px\"}}></div>\r\n\t    \r\n    \t <div className={eStyles.row}>\r\n        <div className={eStyles.column + \" \" + eStyles.smallColumn}>\r\n           {this.state.lessons.map(function(less, k){\r\n            return <SelectLessonForm key={k} lesson={less} handleSelectLesson={handleSelectLesson}/>\r\n           })}\r\n\r\n        </div>\r\n        <div className={eStyles.column}>\r\n\r\n                <NewLineForm index={0} handleNewLine={handleNewLine}/>\r\n\r\n              {this.state.lines.map(function(line, i){\r\n\r\n                if(line.lesson === lesson){\r\n                  \r\n                  return <div key={i}>\r\n                        \r\n                          <button onClick={toggleRaw}>raw</button> > \r\n                                <textarea \r\n                                 readOnly \r\n                                 className={eStyles.raw} style={rawStyle}\r\n                                 value={JSON.stringify(line)}\r\n                                 onClick={copyTextToClipboard}\r\n                              />\r\n\r\n                            <div className={eStyles.row} style={{height:\"400px\", overflow:\"scroll\"}}>\r\n                              <div className={eStyles.column}>\r\n                                <Line index={i} data={line} update={update} style={columnStyle}/>\r\n                                <button style={{color:\"red\", marginLeft:\"15px\"}} onClick={(e)=>{\r\n                                  deleteLine(i)\r\n                                }}>x</button>\r\n                                <MoveToLessonForm index={i} lesson={line.lesson} handleMoveToLesson={moveToLesson}/>\r\n                                \r\n                              </div>\r\n\r\n                            <div className={eStyles.column} style={{fontSize:\"60%\", paddingLeft:\"15px\"}}>\r\n                              <Line index={i} data={line} read={true} style={columnStyle}/>\r\n                            </div>\r\n\r\n                            <NewLineForm index={i+1} handleNewLine={handleNewLine}/>\r\n                          </div>\r\n\r\n                       </div>\r\n                  }\r\n              })}\r\n\r\n        </div>\r\n      </div>\r\n\r\n\r\n\r\n\t\t</main>\r\n\r\n\r\n</div>\r\n    );\r\n  }\r\n\r\nsave(){\r\n\tconst txt = JSON.stringify(this.state.lines)\r\n\tlocalStorage.setItem(this.props.router.query.course, txt)\r\n\r\n\t// Start file download.\r\n\tthis.download(this.props.router.query.course+\".json\",txt);\r\n}\r\n\r\ndownload(filename, text) {\r\n  var element = document.createElement('a');\r\n  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\r\n  element.setAttribute('download', filename);\r\n\r\n  element.style.display = 'none';\r\n  document.body.appendChild(element);\r\n\r\n  element.click();\r\n\r\n  document.body.removeChild(element);\r\n}\r\n\r\ngetFile(event) {\r\n\tconst input = event.target\r\n  if ('files' in input && input.files.length > 0) {\r\n\t  const lines = this.placeFileContent(input.files[0]).then((lines)=>{\r\n\t  \tthis.setState({lines:lines, lessons: this.getLessons(lines)})\r\n\t  })\r\n\r\n  \t}\r\n}\r\n\r\nplaceFileContent(file) {\r\n\treturn this.readFileContent(file).then(content => {\r\n  \treturn JSON.parse(content)\r\n  }).catch(error => console.log(error))\r\n}\r\n\r\nreadFileContent(file) {\r\n\tconst reader = new FileReader()\r\n  return new Promise((resolve, reject) => {\r\n    reader.onload = event => resolve(event.target.result)\r\n    reader.onerror = error => reject(error)\r\n    reader.readAsText(file)\r\n  })\r\n}\r\n\r\nhandleNewLine(e){\r\n    e.preventDefault();\r\n\r\n    const lineType = e.target.lineType.value\r\n    const index = e.target.index.value\r\n\r\n    let newState = {...this.state}\r\n\r\n    if(lineType === \"raw\"){\r\n      newState.lines.splice(index, 0, {...JSON.parse(e.target.raw.value), lesson:this.state.lesson})\r\n    }else{\r\n      newState.lines.splice(index, 0, {...templates[lineType], lesson:this.state.lesson})  \r\n    }\r\n    \r\n    newState.lessons = this.getLessons(newState.lines)\r\n    this.setState({...newState})\r\n}\r\n\r\nhandleMoveToLesson(e){\r\n    e.preventDefault();\r\n    const lesson = parseInt(e.target.lesson.value)\r\n    const index = e.target.index.value\r\n\r\n    let newState = {...this.state}\r\n    newState.lines[index].lesson = lesson\r\n    newState.lessons = this.getLessons(newState.lines)\r\n\r\n    this.setState({...newState})\r\n}\r\n\r\nhandleSelectLesson(e){\r\n    e.preventDefault();\r\n    const id = e.target.id.value\r\n    let newState = {...this.state}\r\n    newState.lesson = parseInt(id)\r\n    this.setState({...newState})\r\n}\r\n\r\nupdate(line, data){\r\n    let newState = {...this.state}\r\n    newState.lines[line] = {...data}\r\n    newState.lessons = this.getLessons(newState.lines)\r\n    this.setState(newState)\r\n}\r\n\r\ndeleteLine(line){\r\n    let newData = {...this.state}\r\n    newData.lines.splice(line, 1);\r\n    newData.lessons = this.getLessons(newData.lines)\r\n    this.setState(newData)\r\n}\r\n\r\ngetLessons(lines){\r\n\r\n  let lessons = []\r\n  let i;\r\n  let id = 0;\r\n  let lindex = 0;\r\n\r\n  for(i = 0; i < lines.length; i++){\r\n    id = parseInt(lines[i].lesson)\r\n    lindex = id-1\r\n\r\n    if(lessons[lindex] === undefined){\r\n      lessons[lindex] = {id:id, count:1}\r\n    }else{\r\n      lessons[lindex] = {id:id, count:lessons[lindex].count+1}\r\n    }\r\n    \r\n  }\r\n\r\n  return lessons\r\n}\r\n\r\ntoggleRaw(e){\r\n  let newState = {...this.state}\r\n  newState.showRaw = !newState.showRaw\r\n  this.setState(newState)\r\n}\r\n\r\n  copyTextToClipboard(e){\r\n    const context = e.target;\r\n    context.select();\r\n    document.execCommand(\"copy\");\r\n    alert(\"Copied to clipoard!\" + context.value)\r\n  }\r\n\r\n}\r\nexport default withRouter(Editor)\r\n\r\n/*\r\n1-4 Ellyanna\r\n5-11 Jeremiah\r\n12-16 Benjamin\r\n17-22 Rosemary\r\n\r\n1. Summaries\r\n2. Conclusing of Book 1 sentence\r\n\r\n\t\t<Quiz line={1} questions={this.state.questions} updateQuestion={updateQuestion}/>\r\n\r\n    */"]},"metadata":{},"sourceType":"module"}